# =============================================================================
# Proxmox environment config — EXAMPLE
#
# Copy this folder and fill in your values:
#   cd environments
#   cp -r proxmox-example/ proxmox-homelab/
#   vim proxmox-homelab/config.yml
#
# Deploy:
#   cd ansible
#   ansible-playbook proxmox-deploy.yml -e env=../environments/proxmox-homelab
#
# Destroy:
#   ansible-playbook proxmox-destroy.yml -e env=../environments/proxmox-homelab
# =============================================================================

# --- Platform ---
# Must be "proxmox" or "vps". Controls which playbook to use.
platform: proxmox

# --- Proxmox connection ---
proxmox_host: 192.168.122.70
proxmox_node: pve
proxmox_api_user: root@pam
proxmox_api_token_id: terraform
proxmox_api_token_secret: REPLACE_ME

# SSH access to Proxmox host (for talosctl/kubectl/helm — VMs are on internal network)
proxmox_ssh_host: 192.168.122.70
proxmox_ssh_user: root

# --- Talos ---
talos_version: v1.12.4
# Schematic ID from factory.talos.dev (includes extensions: iscsi-tools, util-linux-tools, qemu-guest-agent)
talos_schematic_id: e187c9b90f773cd8c84e5a3265c5554ee787b2fe67b508d9f955e90e7ae8c96c
talos_install_disk: /dev/sda

# --- Cluster ---
cluster_name: fluodata
cluster_vip: 10.10.0.5

# --- Network ---
vm_bridge: vmbr1
vm_gateway: 10.10.0.1
vm_subnet_mask: 24
vm_nameservers:
  - 10.10.0.1
  - 1.1.1.1

# --- VM defaults ---
vm_storage: local-lvm
talos_iso_storage: local

# --- DHCP (dnsmasq) ---
# Optional — these have sensible defaults. Only set if your network differs.
# dhcp_range_start: 10.10.0.100
# dhcp_range_end: 10.10.0.200
# dhcp_lease_time: 12h

# --- Nodes ---
# Each node needs: name, vmid, host, mac, cores, memory, boot_disk_gb
# host: IPv4 address for the VM (used for DHCP reservation + Talos static IP)
# Workers can additionally have: longhorn_disk_gb
controlplane_nodes:
  - name: cp-0
    vmid: 110
    host: 10.10.0.10
    mac: "BC:24:11:01:01:01"
    cores: 2
    memory: 4096
    boot_disk_gb: 20

worker_nodes:
  - name: worker-0
    vmid: 120
    host: 10.10.0.20
    mac: "BC:24:11:02:01:01"
    cores: 4
    memory: 8192
    boot_disk_gb: 20
    longhorn_disk_gb: 20
  - name: worker-1
    vmid: 121
    host: 10.10.0.21
    mac: "BC:24:11:02:01:02"
    cores: 4
    memory: 8192
    boot_disk_gb: 20
    longhorn_disk_gb: 20

# --- Cilium ---
cilium_version: "1.17.3"
